# -*- coding: utf-8 -*-

from rag_helpers import RAG_OpenSearch, EmbeddingModel


############# SET EMBEDDING MODEL ############


em = EmbeddingModel(EmbeddingModel.BGE_RERANKER_V2_M3)


############# INITIAL OPENSEARCH ############


HOST = 'localhost'
PORT = 9200
USERNAME = 'admin'
PASSWORD = '@PassWord.1234'

ros = RAG_OpenSearch()
ros.connect_vector_db(host=HOST, port=PORT, username=USERNAME, password=PASSWORD)
ros.set_embedding_model(em)


############# CREATE VECTOR SPACE ############


VEC_SPACE = 'rag_5'

ros.delete_vector_space(VEC_SPACE)
ros.create_vector_space(VEC_SPACE)


############# ADD ONE ITEM and QUERY ############

item = {'text':'OpenSearch with BGE-M3 embedding example.', 'doc':'rag'}

ros.store_one_item(VEC_SPACE, item=item)
ros.query(VEC_SPACE, 'BGE-M3 how')


############# ADD MANY ITEMS and QUERY ############


items = [
    { "text": "ตู้เย็นแบบสองประตูเหมาะสำหรับครอบครัวขนาดกลางถึงใหญ่ มีช่องแช่แข็งแยกออกจากช่องแช่เย็น ทำให้ง่ายต่อการจัดเก็บอาหารสดและอาหารแช่แข็งอย่างเป็นระเบียบ และยังช่วยลดกลิ่นปะปนกันภายในตู้.",
      "doc": "device" },
    { "text": "เครื่องซักผ้าฝาหน้าถูกออกแบบมาให้ประหยัดพลังงานและน้ำ พร้อมระบบหมุนปั่นที่มีประสิทธิภาพสูง สามารถขจัดคราบฝังลึกได้อย่างหมดจด เหมาะสำหรับการใช้งานในครัวเรือนที่ต้องการประสิทธิภาพการซักที่ดีเยี่ยม.",
      "doc": "device" },
    { "text": "ไมโครเวฟแบบดิจิทัลช่วยให้การอุ่นอาหารเป็นเรื่องง่ายและรวดเร็ว มาพร้อมฟังก์ชันละลายน้ำแข็งอัตโนมัติและโปรแกรมทำอาหารหลากหลาย ทำให้เหมาะกับผู้ที่มีเวลาจำกัดในการทำอาหารแต่ยังต้องการความสะดวกสบาย.",
      "doc": "device" },
    { "text": "เครื่องปรับอากาศแบบติดผนังสามารถควบคุมอุณหภูมิและความชื้นในห้องได้อย่างมีประสิทธิภาพ พร้อมระบบฟอกอากาศในตัว ช่วยกรองฝุ่นละอองและกลิ่นไม่พึงประสงค์ เหมาะสำหรับใช้ในห้องนอนหรือห้องนั่งเล่น.",
      "doc": "device" },
    { "text": "หม้อหุงข้าวไฟฟ้ามาพร้อมเทคโนโลยีควบคุมความร้อนอัจฉริยะ ทำให้ข้าวสุกทั่วถึง นุ่ม และหอมทุกเม็ด นอกจากนี้ยังมีโหมดการหุงสำหรับข้าวกล้อง โจ๊ก และการอุ่นอัตโนมัติ เหมาะกับทุกครอบครัว.",
      "doc": "device" },
    
    { "text": "ข้าวมันไก่เป็นอาหารจานเดียวที่ได้รับความนิยมอย่างแพร่หลาย ประกอบด้วยข้าวที่หุงด้วยน้ำซุปไก่จนมีกลิ่นหอม เสิร์ฟคู่กับไก่ต้มเนื้อนุ่ม น้ำจิ้มรสจัด และน้ำซุปใสร้อน ๆ ถือเป็นเมนูที่อร่อยและอิ่มท้องในราคาย่อมเยา.",
      "doc": "food" },
    { "text": "ต้มยำกุ้งเป็นอาหารไทยที่มีรสชาติจัดจ้านและกลิ่นหอมของสมุนไพรสด เช่น ตะไคร้ ใบมะกรูด และข่า จุดเด่นคือความเปรี้ยวจากมะนาวและเผ็ดจากพริกขี้หนู รสชาติกลมกล่อมเมื่อทานกับข้าวสวยร้อน ๆ.",
      "doc": "food" },
    { "text": "ผัดไทยเป็นอาหารจานเดียวที่มีต้นกำเนิดจากอาหารริมทางในประเทศไทย เส้นจันท์ผัดกับน้ำปรุงรสเข้มข้น ใส่กุ้ง เต้าหู้ และไข่ โรยด้วยถั่วลิสงบด เสิร์ฟพร้อมถั่วงอกและมะนาว เหมาะกับทั้งคนไทยและนักท่องเที่ยว.",
      "doc": "food" },
    { "text": "แกงเขียวหวานไก่เป็นเมนูแกงไทยที่มีกลิ่นหอมเฉพาะตัวจากพริกแกงเขียวหวานและกะทิ รสชาติกลมกล่อม หวานมัน และเผ็ดเล็กน้อย นิยมรับประทานคู่กับข้าวสวยหรือขนมจีน เพิ่มรสชาติให้อาหารมื้อนั้นพิเศษยิ่งขึ้น.",
      "doc": "food" },
    { "text": "ส้มตำไทยเป็นสลัดมะละกอดิบที่มีรสเปรี้ยว หวาน เค็ม และเผ็ดผสมผสานกันอย่างลงตัว มักใส่ถั่วลิสง กุ้งแห้ง และมะเขือเทศ ทานคู่กับข้าวเหนียวและไก่ย่าง เป็นเมนูยอดฮิตของภาคอีสานที่คนทั่วประเทศชื่นชอบ.",
      "doc": "food" }
]

ros.store_many_items(VEC_SPACE, items)


ros.query(VEC_SPACE, "มีข้าวมันไก่เป็นอาหารจานเดียวที่ได้รับความนิยมอย่างแพร่หลาย", 2)



